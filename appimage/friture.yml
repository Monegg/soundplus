# AppImage recipe for friture
# takes the pyinstaller output and packages it as an AppImage

app: friture

ingredients:
  dist: xenial
  sources:
    - deb http://us.archive.ubuntu.com/ubuntu/ xenial main universe
  packages:
    - libportaudio2

script:
  - echo $PWD
  - cp ../../../appimage/friture.desktop .
  - cp ../../../resources/images-src/window-icon.svg friture.svg
  - cp -R ../../../dist/friture/* usr/bin/
  # adjust LD_LIBRARY_PATH so that ctypes.find_library finds portaudio
  - echo '#!/bin/bash
  - HERE="$(dirname "$(readlink -f "${0}")")"
  - export LD_LIBRARY_PATH="$HERE/usr/lib/x86_64-linux-gnu":$LD_LIBRARY_PATH
  - "$HERE/usr/bin/friture" "$@" | cat' > AppRun
